<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../css/common.css" />

    <link rel="stylesheet" type="text/css" href="../css/main.css">
    <link rel="stylesheet" type="text/css" href="../css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../css/define.css">

    <title>ccpool</title>


</head>
<body class="sidebar-mini fixed  pace-done">
<div class="pace  pace-inactive">
    <div class="pace-progress" data-progress-text="100%" data-progress="99"
         style="transform: translate3d(100%, 0px, 0px);">
        <div class="pace-progress-inner"></div>
    </div>
    <div class="pace-activity"></div>
</div>
<div class="wrapper">
    <!-- Navbar-->
    <header class="main-header hidden-print"><a class="logo" href="/html/index.html" style="margin-top:0px;font-size:40px;text-align:center;">ccpool</a>
        <nav class="navbar navbar-static-top">
            <a class="sidebar-toggle" href="/html/index.html" data-toggle="offcanvas"></a>
            <!-- Navbar Right Menu-->
            <div class="navbar-custom-menu">
                <ul class="top-nav">
                    <!--Notification Menu-->
                    <li class="dropdown notification-menu">
                        <a class="dropdown-toggle" href="/html/index.html" data-toggle="dropdown"
                           aria-expanded="false">
                            <i class="fa fa-bell-o fa-lg"></i>
                        </a>
                        <ul class="dropdown-menu">
                            <li class="not-head">你有4个消息待查看</li>
                            <li><a class="media" href="javascript:;"><span class="media-left media-icon"><span
                                    class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-primary"></i><i
                                    class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></span>
                                <div class="media-body"><span class="block">有尚未审批的工单待处理</span><span
                                        class="text-muted block">2分钟前</span></div>
                            </a></li>
                            <li><a class="media" href="javascript:;"><span class="media-left media-icon"><span
                                    class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-danger"></i><i
                                    class="fa fa-hdd-o fa-stack-1x fa-inverse"></i></span></span>
                                <div class="media-body"><span class="block">你的密码是初始密码，请速修改</span><span
                                        class="text-muted block">1天前</span></div>
                            </a></li>
                            <li><a class="media" href="javascript:;"><span class="media-left media-icon"><span
                                    class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x text-success"></i><i
                                    class="fa fa-money fa-stack-1x fa-inverse"></i></span></span>
                                <div class="media-body"><span class="block">有合约即将到期，请联系客户续约</span><span
                                        class="text-muted block">5天前</span></div>
                            </a></li>
                            <li class="not-footer"><a href="#">查看所有提醒</a></li>
                        </ul>
                    </li>
                    <!-- User Menu-->
                    <li class="dropdown">
                        <a class="dropdown-toggle" href="/html/index.html" data-toggle="dropdown" role="button"
                           aria-haspopup="true" aria-expanded="false">
                            <i class="fa fa-user fa-lg"></i>
                        </a>
                        <ul class="dropdown-menu settings-menu">
                            <li><a href="#"><i
                                    class="fa fa-cog fa-lg"></i> 设置</a></li>
                            <li><a href="#"><i
                                    class="fa fa-user fa-lg"></i>配置</a></li>
                            <li><a href="/html/index.html"><i
                                    class="fa fa-sign-out fa-lg"></i>退出</a></li>
                        </ul>
                    </li>
                </ul>
            </div>
        </nav>
    </header>
    <!-- Side-Nav-->
    <aside class="main-sidebar hidden-print">
        <div class="slimScrollDiv" style="position: relative; overflow: hidden; width: auto; height: 1284px;">
            <section class="sidebar" style="overflow: hidden; width: auto; height: 1284px;">
                <div class="user-panel">
                    <div class="pull-left image"><img class="img-circle" src="../images/48.jpg" alt="User Image"></div>
                    <div class="pull-left info">
                        <p id="userName"></p>
                        <p class="designation">超级管理员</p>
                    </div>
                </div>
                <!-- Sidebar Menu-->
                <ul class="sidebar-menu">
                    <li class="active">
                        <a href="#" onclick="jump(0)"><i class="fa fa-dashboard"></i><span>点播视频管理</span></a>
                    </li>
                    <li class="active">
                        <a href="#" onclick="jump(10)"><i class="fa fa-dashboard"></i><span>工单管理</span></a>
                    </li>
                    <li class="active">
                        <a href="#" onclick="jump(6)"><i class="fa fa-dashboard"></i><span>参数设置</span></a>
                    </li>
                    <li class="active">
                        <a href="#" onclick="jump(7)"><i class="fa fa-dashboard"></i><span>公告管理</span></a>
                    </li>
                    <li class="active">
                        <a href="#" onclick="jump(8)"><i class="fa fa-dashboard"></i><span>常见问题管理</span></a>
                    </li>
                    <li class="active">
                        <a href="#" onclick="jump(9)"><i class="fa fa-dashboard"></i><span>留言管理</span></a>
                    </li>
                </ul>
            </section>
            <div class="slimScrollBar"
                 style="background: rgba(0, 0, 0, 0.8); width: 3px; position: absolute; top: 0px; opacity: 0.4; display: none; border-radius: 7px; z-index: 99; right: 1px; height: 1284px;"></div>
            <div class="slimScrollRail"
                 style="width: 3px; height: 100%; position: absolute; top: 0px; display: none; border-radius: 7px; background: rgb(51, 51, 51); opacity: 0.2; z-index: 90; right: 1px;"></div>
        </div>
    </aside>

    <div class="content-wrapper" id="user_page">
        <div class="page-title" style="margin:-25px -20px;">
            <div>
                <h1><i class="fa fa-dashboard"></i><span id="spanJump"><a href="#" onclick="jump(1)">播放地址管理</a></span></h1>
            </div>
            <div>
                <ul class="breadcrumb">
                    <li><i class="fa fa-home fa-lg"></i></li>
                    <li><a href="/html/index.html">首页</a></li>
                </ul>
            </div>
        </div>

        <div class="card-body" style="margin:35px -20px;">
            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="row">
                            <div class="col-lg-6">
                                <div class="well bs-component">
                                    <form class="form-horizontal">
                                        <fieldset>
                                            <legend>添加播放地址</legend>
                                            <div class="form-group">
                                                <label class="col-lg-2 control-label" for="title">名称</label>
                                                <div class="col-lg-10">
                                                    <input class="form-control" id="title" type="text" placeholder="名称">
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="col-lg-2 control-label">提供者</label>
                                                <div class="col-lg-10">
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="0"><span class="label-text">系统自有</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="1"><span class="label-text">优酷</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="2"><span class="label-text">芒果TV</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="3"><span class="label-text">爱奇艺</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="4"><span class="label-text">腾讯视频</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="5"><span class="label-text">搜狐视频</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="6"><span class="label-text">抖音</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="7"><span class="label-text">梨视频</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="8"><span class="label-text">快视频</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="9"><span class="label-text">咪咕视频</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="10"><span class="label-text">韩剧TV</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="provider" value="30"><span class="label-text">搜你妹</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="form-group">
                                                <label class="col-lg-2 control-label" for="url">播放地址</label>
                                                <div class="col-lg-10">
                                                    <input class="form-control" id="url" type="text" placeholder="播放地址">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-2 control-label" for="page_url">爬取网址</label>
                                                <div class="col-lg-10">
                                                    <input class="form-control" id="page_url" type="text" placeholder="爬取网址">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-2 control-label">清晰度</label>
                                                <div class="col-lg-10">
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="quality" value="0"><span class="label-text">普清</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="quality" value="1"><span class="label-text">标清</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="quality" value="2"><span class="label-text">高清</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="quality" value="3"><span class="label-text">超清</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-2 control-label" for="sort">排序</label>
                                                <div class="col-lg-10">
                                                    <input class="form-control" id="sort" type="text" placeholder="排序">
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <label class="col-lg-2 control-label">是否上线</label>
                                                <div class="col-lg-10">
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="on_line" value="1"><span class="label-text">是</span>
                                                        </label>
                                                    </div>
                                                    <div class="radio-inline animated-radio-button">
                                                        <label>
                                                            <input type="radio" name="on_line" value="0"><span class="label-text">否</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="form-group">
                                                <div class="col-lg-10 col-lg-offset-2">
                                                    <button class="btn btn-default" type="button">取消</button>
                                                    <button class="btn btn-primary" type="button" onclick="AddPlayUrl()">提交</button>
                                                </div>
                                            </div>
                                        </fieldset>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>

    </div>

</div>

<div id="dialogBg"></div>
<div id="dialog" class="animated">
    <img class="dialogIco" width="50" height="50" src="images/ico.png" alt="" />
    <div class="dialogTop">
        <a href="javascript:;" class="claseDialogBtn">关闭</a>
    </div>
    <form hidden action="" method="post" id="user_add_form">
        <ul class="editInfos">
            <li><span style="color:red;">* </span><span style="color:#000000;">姓名：</span><input type="text" name="" required value="" class="ipt" /></li>
            <li><span style="color:red;">* </span><span style="color:#000000;">账号：</span><input type="text" name="" required value="" class="ipt" /></li>
            <li><span style="color:red;">&nbsp; </span><span style="color:#000000;">邮箱：</span><input type="text" name="" required value="" class="ipt" /></li>
            <li><input type="submit" value="确认提交" class="submitBtn" /></li>
        </ul>
    </form>

    <form hidden action="" method="post" id="son_add_form">
        <ul class="editInfos">
            <li><span style="color:red;">* </span><span style="color:#000000;">钱包地址：</span><input type="text" name="" required value="" class="ipt" /></li>
            <li><input type="submit" value="确认提交" class="submitBtn" /></li>
        </ul>
    </form>

    <form hidden action="" method="post" id="user_update_form">
        <ul class="editInfos">
            <li><span style="color:red;">* </span><span style="color:#000000;">姓名：</span><input type="text" name="name" required value="" class="ipt" /></li>
            <li><span style="color:red;">* </span><span style="color:#000000;">账号：</span><input type="text" name="account" required value="" class="ipt" /></li>
            <li><span style="color:red;">&nbsp; </span><span style="color:#000000;">邮箱：</span><input type="text" name="email" value="" class="ipt" /></li>
            <li><span style="color:red;">* </span><span style="color:#000000;">状态：</span>
                <select id="select_user_state" class="ipt">
                    <option>正常</option>
                    <option>冻结</option>
                </select>
            </li>
            <li><span style="color:red;">* </span><span style="color:#000000;">利率：</span><input type="text" name="rate" required value="" class="ipt" /></li>
            <li><input type="submit" value="确认提交" class="submitBtn" /></li>
            <input type="hidden" id="hidSearch" />
        </ul>
    </form>

</div>

<!-- Javascripts-->
<script src="../js/jquery-2.1.4.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/pace.min.js"></script>
<script src="../js/main.js"></script>
<script src="../js/prototype.js"></script>
<script src="../js/webcommon.js"></script>
<script src="../js/all.js"></script>

<script type="text/javascript" src="../js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="../js/dataTables.bootstrap.min.js"></script>

<script type="text/javascript">

    function getParam(paramName) {
        paramValue = "", isFound = !1;
        if (this.location.search.indexOf("?") == 0 && this.location.search.indexOf("=") > 1) {
            arrSource = unescape(this.location.search).substring(1, this.location.search.length).split("&"), i = 0;
            while (i < arrSource.length && !isFound) arrSource[i].indexOf("=") > 0 && arrSource[i].split("=")[0].toLowerCase() == paramName.toLowerCase() && (paramValue = arrSource[i].split("=")[1], isFound = !0), i++
        }
        return paramValue == "" && (paramValue = null), paramValue
    }

    var w,h;
    function getSrceenWH(){
        w = $(window).width();
        h = $(window).height();
        $('#dialogBg').width(w).height(h);
    }

    window.onresize = function(){
        getSrceenWH();
    }
    $(window).resize();

    getSrceenWH();

    function closeDialog(){
        $('#dialogBg').fadeOut(100,function(){
            $('#dialog').addClass('bounceOutUp').fadeOut();
        });
    }

    $("#dialog").css("position","absolute");
    $("#dialog").css("left","50%");
    $("#dialog").css("top","50%");

    //显示弹框
    $('#btnAddUserDialog').click(function(){
        $("#user_add_form").show();

        $("#dialog").css("width","320px");
        $("#dialog").css("height","240px");
        $(".ipt").css("width","200px");

        $("#dialog").css("margin","-120px 0 0 -160px");

        $('#dialogBg').fadeIn(100);
        $('#dialog').removeAttr('class').addClass('animated bounceIn').fadeIn();
    });

    $('#btnAutoAddUser').click(function(){
        var token = getParam("Authorization");

        var url = "/ams/user/autocreate?Authorization="+token;

        $.getJSON(url, function(json) {
            if(json.err_code == 0) {
                alert("新增用户成功")
            }else{
                toastr.warning("获取机器模板失败!!!");
            }
        });
    });

    //关闭弹窗
    $('.claseDialogBtn').click(function(){
        $("#config_machine").hide();
        $("#config_pow").hide();
        $("#radio_pow").removeAttr("checked");
        $("#radio_machine").removeAttr("checked");


        $('#dialogBg').fadeOut(100,function(){
            $('#dialog').addClass('bounceOutUp').fadeOut();
            $("#user_list_table").hide();
            $("#user_list_table_tbody").html("");
        });
    });

    function VideoPageInit(){
        var userName = $.cookie("admin_name");
        $("#userName").text(userName);

        var token = getParam("Authorization");

        $.getJSON("/ams/admin/video/list?Authorization="+token, function(json) {
            if(json.err_code == 0) {
                var tbody = "";
                for (var i = 0; i < json.data.length; i++) {

                    var onLine = "上映";
                    if(json.data[i].online == false){
                        state = "下线"
                    }
                    tbody += "<tr role='row' class='odd'>";
                    tbody += "<td>" + json.data[i].id + "</td>";
                    tbody += "<td><a href='#' onclick='jump(4," + json.data[i].id + ")'>" + json.data[i].title + "</a></td>";
                    tbody += "<td>" + json.data[i].directors + "</td>";
                    tbody += "<td>" + json.data[i].actors + "</td>";
                    tbody += "<td>" + onLine + "</td>";
                    tbody += "<td>" + json.data[i].score + "</td>";
                    tbody += "<td>" + json.data[i].publish_date + "</td>";
                    tbody += "<td><a href='#' onclick='DeleteVideo("+json.data[i].id +")'>删除</a><a href='#' style='margin-left:10px;' onclick='UpdateVideo(" + json.data[i].id +")'>修改</a><a href='#' style='margin-left:10px;' onclick='AddEpisode("+ json.data[i].id +")'>添加剧集</a></td>";
                    tbody += "</tr>";
                }

                $("#video_manager_table_tbody").html(tbody);

                var table = $('#video_manager_table').dataTable({
                    "bStateSave": false,//状态保存
                    "bPaginate": true, //翻页功能
                    "bLengthChange": true, //改变每页显示数据数量
                    "bFilter": true, //过滤功能
                    "bSort": true, //排序功能
                    "paging": true,
                    "retrieve": true,
                    "bInfo": true,//页脚信息
                    "bAutoWidth": true,//自动宽度
                    "iDisplayLength" : 25,// 每页显示行数
                    "aaSorting" : [[1, "asc"]], //默认的排序方式，第2列，升序排列
                    "oLanguage": {
                        "sLengthMenu": "每页显示 _MENU_ 条记录",
                        "sZeroRecords": "对不起，查询不到任何相关数据",
                        "sInfo": "当前显示 _START_ 到 _END_ 条，共 _TOTAL_ 条记录",
                        "sInfoEmtpy": "找不到相关数据",
                        "sInfoFiltered": "数据表中共为 _MAX_ 条记录)",
                        "sProcessing": "正在加载中...",
                        "sSearch": "搜索",
                        "sUrl": "", //多语言配置文件，可将oLanguage的设置放在一个txt文件中，例：Javascript/datatable/dtCH.txt
                        "oPaginate": {
                            "sFirst":    "第一页",
                            "sPrevious": " 上一页 ",
                            "sNext":     " 下一页 ",
                            "sLast":     " 最后一页 "
                        }
                    }
                });

                table.search("").draw();


            }else{
                toastr.warning("获取用户列表失败!!!");
            }
        });
    }

    VideoPageInit();

    function AddPlayUrl() {
        var token = getParam("Authorization");
        var content_type = getParam("content_type");
        var content_id = getParam("content_id");

        var title = $("#title").val();
        var provider = $("input[name='provider']:checked").val();
        var url = $("#url").val();
        var page_url = $("#page_url").val();
        var quality = $("input[name='quality']:checked").val();

        var sort = $("#sort").val();
        var on_line = $("input[name='on_line']:checked").val();

        alert(content_type)
        alert(content_id)
        alert(title)
        alert(provider)


        $.ajax({
            //提交数据的类型 POST GET
            type:"POST",
            //提交的网址
            url:"/ams/admin/playurl/add",
            //提交的数据
            data:{Authorization:token,content_type:content_type,title:title,content_id:content_id,provider:provider,url:url,
                page_url:page_url,quality:quality,sort:sort,on_line:on_line},
            //返回数据的格式
            datatype: "json",//"xml", "html", "script", "json", "jsonp", "text".
            //在请求之前调用的函数
            beforeSend:function(){},
            //成功返回之后调用的函数
            success:function(json){
                if(json.err_code != 0){
                    alert(json.err_msg);
                }else{
                    alert("添加成功!!!");
                }
            }   ,
            //调用执行后调用的函数
            complete: function(XMLHttpRequest, textStatus){

            },
            //调用出错执行的函数
            error: function(){
                //请求出错处理
            }
        });

    }


    function UpdateUser(user) {
        $("#user_update_form").show();

        $("#dialog").css("width","400px");
        $("#dialog").css("height","320px");
        $(".ipt").css("width","180px");
        $("select").css("width","180px");

        $("#user_update_form").find("input").eq(0).val(user.name);
        $("#user_update_form").find("input").eq(1).val(user.account);
        $("#user_update_form").find("input").eq(2).val(user.email);
        $("#user_update_form").find("input").eq(3).val(user.rate);

        var state = "";
        if(user.state == 1){
            state = "正常"
        }else if(user.state == 2){
            state = "冻结"
        }
        $("#user_update_form").find("select").eq(0).val(state);


        $('#dialogBg').fadeIn(100);
        $('#dialog').removeAttr('class').addClass('animated bounceIn').fadeIn();
    }

</script>

</body>
</html>